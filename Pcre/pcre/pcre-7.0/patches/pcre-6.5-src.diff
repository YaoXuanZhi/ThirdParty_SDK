diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/Makefile.in pcre-6.5-src/Makefile.in
--- pcre-6.5-orig/Makefile.in	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/Makefile.in	2006-02-05 11:29:41.140625000 +0100
@@ -22,8 +22,7 @@ PCREGREP_OSTYPE=-DIS_UNIX
 # thinks is it not up-to-date when in fact it is. This setting helps when
 # GNU "make" is being used. It presumably does no harm in other cases.
 
-VPATH=.libs
-
+VPATH=. .libs @top_srcdir@ @top_builddir@ $(resdir) 
 
 #---------------------------------------------------------------------------#
 # The following lines are modified by "configure" to insert data that it is #
@@ -34,6 +33,7 @@ SHELL = @SHELL@
 prefix = @prefix@
 exec_prefix = @exec_prefix@
 top_srcdir = @top_srcdir@
+resdir = $(top_builddir)/res
 
 mkinstalldirs = $(SHELL) $(top_srcdir)/mkinstalldirs
 
@@ -68,17 +68,23 @@ BUILD_OBJEXT = @BUILD_OBJEXT@
 # POSIX_OBJ and POSIX_LOBJ are either set empty, or to the names of the
 # POSIX object files.
 
+@ON_WINDOWS@  POSIX_LIB=libpcreposix.la
+@NOT_ON_WINDOWS@  POSIX_LIB=@POSIX_LIB@
 POSIX_OBJ = @POSIX_OBJ@
-POSIX_LOBJ = @POSIX_LOBJ@
+POSIX_LOBJ = @POSIX_LOBJ@ \
+@ON_WINDOWS@  pcreposix-dll-res.lo \
+@ON_WINDOWS@  pcreposix-dllversion.lo
+DLLPOSIXOBJ = $(POSIX_OBJ) pcreposix-dll-res.@OBJEXT@  pcreposix-dllversion.@OBJEXT@
 
 # The compiler, C flags, preprocessor flags, etc
 
 CC = @CC@
 CXX = @CXX@
-CFLAGS = @CFLAGS@
-CXXFLAGS = @CXXFLAGS@
-LDFLAGS = @LDFLAGS@
+CFLAGS = @CPPFLAGS@ @CFLAGS@
+CXXFLAGS = @CPPFLAGS@ @CXXFLAGS@
+LDFLAGS = @LDFLAGS@ $(VERSADD)
 CXXLDFLAGS = @CXXLDFLAGS@
+LIBS = @LIBS@
 
 CC_FOR_BUILD = @CC_FOR_BUILD@
 CFLAGS_FOR_BUILD = @CFLAGS_FOR_BUILD@
@@ -104,23 +110,23 @@ INSTALL_DATA = @INSTALL_DATA@
 LIBTOOL = @LIBTOOL@
 LTCOMPILE = $(LIBTOOL) --mode=compile $(CC) -c $(CFLAGS) -I. -I$(top_srcdir) $(NEWLINE) $(LINK_SIZE) $(MATCH_LIMIT) $(NO_RECURSE) $(EBCDIC)
 LTCXXCOMPILE = $(LIBTOOL) --mode=compile $(CXX) -c $(CXXFLAGS) -I. -I$(top_srcdir) $(NEWLINE) $(LINK_SIZE) $(MATCH_LIMIT) $(NO_RECURSE) $(EBCDIC)
-@ON_WINDOWS@LINK = $(CC) $(LDFLAGS) -I. -I$(top_srcdir) -L.libs
-@NOT_ON_WINDOWS@LINK = $(LIBTOOL) --mode=link $(CC) $(CFLAGS) $(LDFLAGS) -I. -I$(top_srcdir)
-LINKLIB = $(LIBTOOL) --mode=link $(CC) -export-symbols-regex '^[^_]' $(LDFLAGS) -I. -I$(top_srcdir)
-LINK_FOR_BUILD = $(LIBTOOL) --mode=link $(CC_FOR_BUILD) $(CFLAGS_FOR_BUILD) $(LDFLAGS_FOR_BUILD) -I. -I$(top_srcdir)
-@ON_WINDOWS@CXXLINK = $(CXX) $(LDFLAGS) -I. -I$(top_srcdir) -L.libs
-@NOT_ON_WINDOWS@CXXLINK = $(LIBTOOL) --mode=link $(CXX) $(LDFLAGS) $(CXXLDFLAGS) -I. -I$(top_srcdir)
-CXXLINKLIB = $(LIBTOOL) --mode=link $(CXX) $(LDFLAGS) -I. -I$(top_srcdir)
+#@ON_WINDOWS@LINK = $(CC) $(LDFLAGS) -I. -I$(top_srcdir) -L.libs  $(LIBS)
+LINK = $(LIBTOOL) --mode=link $(CC) $(CFLAGS) $(LDFLAGS) -I. -I$(top_srcdir) $(LIBS)
+LINKLIB = $(LIBTOOL) --mode=link $(CC) -export-symbols-regex '^[^_]' $(LDFLAGS) -I. -I$(top_srcdir) $(LIBS)
+LINK_FOR_BUILD = $(LIBTOOL) --mode=link $(CC_FOR_BUILD) $(CFLAGS_FOR_BUILD) $(LDFLAGS_FOR_BUILD) -I. -I$(top_srcdir) $(LIBS)
+#@ON_WINDOWS@CXXLINK = $(CXX) $(LDFLAGS) -I. -I$(top_srcdir) -L.libs $(LIBS)
+CXXLINK = $(LIBTOOL) --mode=link $(CXX) $(LDFLAGS) $(CXXLDFLAGS) -I. -I$(top_srcdir) $(LIBS)
+CXXLINKLIB = $(LIBTOOL) --mode=link $(CXX) $(LDFLAGS) -I. -I$(top_srcdir) $(LIBS)
 
 # These are the version numbers for the shared libraries
 
 PCRELIBVERSION = @PCRE_LIB_VERSION@
 PCREPOSIXLIBVERSION = @PCRE_POSIXLIB_VERSION@
 PCRECPPLIBVERSION = @PCRE_CPPLIB_VERSION@
+VERSION = 6.5 # @PCRE_VERSION@
 
 ##############################################################################
 
-
 OBJ = pcre_chartables.@OBJEXT@ \
   pcre_compile.@OBJEXT@ \
   pcre_config.@OBJEXT@ \
@@ -141,6 +147,7 @@ OBJ = pcre_chartables.@OBJEXT@ \
   pcre_version.@OBJEXT@ \
   pcre_xclass.@OBJEXT@ \
   $(POSIX_OBJ)
+DLLOBJ = $(OBJ) pcre-dll-res.@OBJEXT@  pcre-dllversion.@OBJEXT@
 
 LOBJ = pcre_chartables.lo \
   pcre_compile.lo \
@@ -161,31 +168,51 @@ LOBJ = pcre_chartables.lo \
   pcre_valid_utf8.lo \
   pcre_version.lo \
   pcre_xclass.lo \
-  $(POSIX_LOBJ)
+  $(POSIX_LOBJ) \
+@ON_WINDOWS@  pcre-dll-res.lo \
+@ON_WINDOWS@  pcre-dllversion.lo
 
 CPPOBJ = pcrecpp.@OBJEXT@ \
   pcre_scanner.@OBJEXT@ \
-  pcre_stringpiece.@OBJEXT@
+  pcre_stringpiece.@OBJEXT@	\
+@ON_WINDOWS@  pcrecpp-dll-res.@OBJEXT@ \
+@ON_WINDOWS@  pcrecpp-dllversion.@OBJEXT@
 
 CPPLOBJ = pcrecpp.lo \
   pcre_scanner.lo \
-  pcre_stringpiece.lo
+  pcre_stringpiece.lo \
+@ON_WINDOWS@  pcrecpp-dll-res.lo \
+@ON_WINDOWS@  pcrecpp-dllversion.lo
+DLLCPPOBJ = $(CPPLOBJ:.lo=.o)
 
 CPP_TARGETS = libpcrecpp.la \
   pcrecpp_unittest@EXEEXT@ \
   pcre_scanner_unittest@EXEEXT@ \
   pcre_stringpiece_unittest@EXEEXT@
 
-all:            libpcre.la @POSIX_LIB@ pcretest@EXEEXT@ pcregrep@EXEEXT@ \
+.SUFFIXES:
+.SUFFIXES: .c .@OBJEXT@ .rc @EXEEXT@
+
+LIBPCRE = -L. -lpcre
+LATOOL = latool.sh
+RCTOOL = rctool.sh
+RCTOOL_COMPILE = RCTOOL
+# Rule to make compiled resource (Windows)
+.rc.@OBJEXT@:
+	windres --include-dir $(resdir) -i $< -o $@
+.rc.lo:
+	$(RCTOOL_COMPILE) $<
+
+all:            libpcre.la $(POSIX_LIB) pcretest@EXEEXT@ pcregrep@EXEEXT@ \
 		@MAYBE_CPP_TARGETS@ @ON_WINDOWS@ winshared
 
-pcregrep@EXEEXT@: libpcre.la pcregrep.@OBJEXT@ @ON_WINDOWS@ winshared
-		$(LINK) -o pcregrep@EXEEXT@ pcregrep.@OBJEXT@ libpcre.la
+pcregrep@EXEEXT@: libpcre.la pcregrep.@OBJEXT@ @ON_WINDOWS@ pcregrep-res.@OBJEXT@ winshared
+		$(LINK) -o pcregrep@EXEEXT@ pcregrep.@OBJEXT@ pcregrep-res.@OBJEXT@ libpcre.la
 
 pcretest@EXEEXT@: libpcre.la @POSIX_LIB@ pcretest.@OBJEXT@ \
-		@ON_WINDOWS@ winshared
+		@ON_WINDOWS@ pcretest-res.@OBJEXT@ winshared
 		$(LINK) $(PURIFY) $(EFENCE) -o pcretest@EXEEXT@  \
-		pcretest.@OBJEXT@ \
+		pcretest.@OBJEXT@ pcretest-res.@OBJEXT@ \
 		libpcre.la @POSIX_LIB@
 
 pcrecpp_unittest@EXEEXT@: libpcrecpp.la pcrecpp_unittest.@OBJEXT@ \
@@ -208,182 +235,208 @@ pcre_stringpiece_unittest@EXEEXT@: libpc
 		pcre_stringpiece_unittest.@OBJEXT@ \
 		libpcrecpp.la @POSIX_LIB@
 
-libpcre.la:     $(OBJ)
+libpcre.la:     $(DLLOBJ)
 		-rm -f libpcre.la
-		$(LINKLIB) -rpath $(LIBDIR) -version-info \
+		$(LATOOL) -rpath $(LIBDIR) -version-info \
 		'$(PCRELIBVERSION)' -o libpcre.la $(LOBJ)
+		cd .libs && o2dll -o pcre.dll -l libpcre $(DLLOBJ) -version-info $(PCRELIBVERSION) $(LDFLAGS) $(LIBS) 
 
-libpcreposix.la: libpcre.la pcreposix.@OBJEXT@
+libpcreposix.la: libpcre.la $(DLLPOSIXOBJ)
 		-rm -f libpcreposix.la
-		$(LINKLIB) -rpath $(LIBDIR) libpcre.la -version-info \
-		'$(PCREPOSIXLIBVERSION)' -o libpcreposix.la pcreposix.lo
+		$(LATOOL) -rpath $(LIBDIR) libpcre.la -version-info \
+		'$(PCREPOSIXLIBVERSION)' -o libpcreposix.la pcreposix.lo \
+		@ON_WINDOWS@ pcreposix-dll-res.lo pcre-dllversion.lo
+		cd .libs && o2dll -o pcreposix.dll -l libpcreposix  $(DLLPOSIXOBJ) \
+			-version-info $(PCREPOSIXLIBVERSION) $(LDFLAGS) $(LIBPCRE) $(LIBS) 
 
 libpcrecpp.la: libpcre.la $(CPPOBJ)
 		-rm -f libpcrecpp.la
-		$(CXXLINKLIB) -rpath $(LIBDIR) libpcre.la -version-info \
+		$(LATOOL) -rpath $(LIBDIR) libpcre.la -version-info \
 		'$(PCRECPPLIBVERSION)' -o libpcrecpp.la $(CPPLOBJ)
+		cd .libs && o2dll -u -x -v -o pcrecpp.dll -l libpcrecpp $(DLLCPPOBJ) -version-info $(PCRECPPLIBVERSION)  $(LIBPCRE) $(LIBS) 
 
 # Note that files generated by ./configure and by dftables are in the current
 # directory, not the source directory.
 
+pcre.h: $(top_srcdir)/pcre.h
+	cp -fp $< $@
+
 pcre_chartables.@OBJEXT@: pcre_chartables.c
 		@$(LTCOMPILE) pcre_chartables.c
 
-pcre_compile.@OBJEXT@: Makefile config.h pcre.h \
+pcre_compile.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_compile.c \
 		$(top_srcdir)/pcre_printint.src
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_compile.c
 
-pcre_config.@OBJEXT@:  Makefile config.h pcre.h \
+pcre_config.@OBJEXT@:  config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_config.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_config.c
 
-pcre_dfa_exec.@OBJEXT@: Makefile config.h pcre.h \
+pcre_dfa_exec.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_dfa_exec.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_dfa_exec.c
 
-pcre_exec.@OBJEXT@:    Makefile config.h pcre.h \
+pcre_exec.@OBJEXT@:    config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_exec.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_exec.c
 
-pcre_fullinfo.@OBJEXT@: Makefile config.h pcre.h \
+pcre_fullinfo.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_fullinfo.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_fullinfo.c
 
-pcre_get.@OBJEXT@:     Makefile config.h pcre.h \
+pcre_get.@OBJEXT@:     config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_get.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_get.c
 
-pcre_globals.@OBJEXT@: Makefile config.h pcre.h \
+pcre_globals.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_globals.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_globals.c
 
-pcre_info.@OBJEXT@:    Makefile config.h pcre.h \
+pcre_info.@OBJEXT@:    config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_info.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_info.c
 
-pcre_maketables.@OBJEXT@: Makefile config.h pcre.h \
+pcre_maketables.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_maketables.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_maketables.c
 
-pcre_ord2utf8.@OBJEXT@: Makefile config.h pcre.h \
+pcre_ord2utf8.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_ord2utf8.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_ord2utf8.c
 
-pcre_refcount.@OBJEXT@:   Makefile config.h pcre.h \
+pcre_refcount.@OBJEXT@:   config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_refcount.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_refcount.c
 
-pcre_study.@OBJEXT@:   Makefile config.h pcre.h \
+pcre_study.@OBJEXT@:   config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_study.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_study.c
 
-pcre_tables.@OBJEXT@:  Makefile config.h pcre.h \
+pcre_tables.@OBJEXT@:  config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_tables.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_tables.c
 
-pcre_try_flipped.@OBJEXT@: Makefile config.h pcre.h \
+pcre_try_flipped.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_try_flipped.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_try_flipped.c
 
-pcre_ucp_searchfuncs.@OBJEXT@: Makefile config.h pcre.h \
+pcre_ucp_searchfuncs.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h \
 		$(top_srcdir)/pcre_ucp_searchfuncs.c \
 		$(top_srcdir)/ucptable.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_ucp_searchfuncs.c
 
-pcre_valid_utf8.@OBJEXT@: Makefile config.h pcre.h \
+pcre_valid_utf8.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_valid_utf8.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_valid_utf8.c
 
-pcre_version.@OBJEXT@: Makefile config.h pcre.h \
+pcre_version.@OBJEXT@: config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_version.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_version.c
 
-pcre_xclass.@OBJEXT@:  Makefile config.h pcre.h \
+pcre_xclass.@OBJEXT@:  config.h pcre.h \
 		$(top_srcdir)/pcre_internal.h $(top_srcdir)/pcre_xclass.c
 		@$(LTCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_xclass.c
 
 pcreposix.@OBJEXT@:    $(top_srcdir)/pcreposix.c $(top_srcdir)/pcreposix.h \
-		  $(top_srcdir)/pcre_internal.h pcre.h config.h Makefile
+		  $(top_srcdir)/pcre_internal.h pcre.h config.h 
 		@$(LTCOMPILE) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcreposix.c
 
 pcrecpp.@OBJEXT@:      $(top_srcdir)/pcrecpp.cc $(top_srcdir)/pcrecpp.h \
-		pcrecpparg.h pcre_stringpiece.h pcre.h config.h Makefile
+		pcrecpparg.h pcre_stringpiece.h pcre.h config.h 
 		@$(LTCXXCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcrecpp.cc
 
 pcre_scanner.@OBJEXT@: $(top_srcdir)/pcre_scanner.cc \
 		$(top_srcdir)/pcre_scanner.h \
 		$(top_srcdir)/pcrecpp.h pcrecpparg.h pcre_stringpiece.h \
-		pcre.h config.h Makefile
+		pcre.h config.h 
 		@$(LTCXXCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_scanner.cc
 
 pcre_stringpiece.@OBJEXT@:  $(top_srcdir)/pcre_stringpiece.cc \
 		pcre_stringpiece.h \
-		config.h Makefile
+		config.h 
 		@$(LTCXXCOMPILE) $(UTF8) $(UCP) $(POSIX_MALLOC_THRESHOLD) \
 		$(top_srcdir)/pcre_stringpiece.cc
 
 pcretest.@OBJEXT@:     $(top_srcdir)/pcretest.c $(top_srcdir)/pcre_internal.h \
-		$(top_srcdir)/pcre_printint.src pcre.h config.h Makefile
+		$(top_srcdir)/pcre_printint.src pcre.h config.h 
 		$(CC) -c $(CFLAGS) -I. -I$(top_srcdir) $(UTF8) $(UCP) \
 		$(LINK_SIZE) $(top_srcdir)/pcretest.c
 
 pcrecpp_unittest.@OBJEXT@:  $(top_srcdir)/pcrecpp_unittest.cc \
 		$(top_srcdir)/pcrecpp.h \
-		pcrecpparg.h pcre_stringpiece.h pcre.h config.h Makefile
+		pcrecpparg.h pcre_stringpiece.h pcre.h config.h 
 		$(CXX) -c $(CXXFLAGS) -I. -I$(top_srcdir) $(UTF8) $(UCP) \
 		$(LINK_SIZE) $(top_srcdir)/pcrecpp_unittest.cc
 
 pcre_stringpiece_unittest.@OBJEXT@: $(top_srcdir)/pcre_stringpiece_unittest.cc \
-		pcre_stringpiece.h pcrecpparg.h config.h Makefile
+		pcre_stringpiece.h pcrecpparg.h config.h 
 		$(CXX) -c $(CXXFLAGS) -I. -I$(top_srcdir) $(UTF8) $(UCP) \
 		$(LINK_SIZE) $(top_srcdir)/pcre_stringpiece_unittest.cc
 
 pcre_scanner_unittest.@OBJEXT@:  $(top_srcdir)/pcre_scanner_unittest.cc \
 		$(top_srcdir)/pcre_scanner.h \
 		$(top_srcdir)/pcrecpp.h pcre_stringpiece.h \
-		pcre.h pcrecpparg.h config.h Makefile
+		pcre.h pcrecpparg.h config.h 
 		$(CXX) -c $(CXXFLAGS) -I. -I$(top_srcdir) $(UTF8) $(UCP) \
 		$(LINK_SIZE) $(top_srcdir)/pcre_scanner_unittest.cc
 
-pcregrep.@OBJEXT@:     $(top_srcdir)/pcregrep.c pcre.h Makefile config.h
+pcregrep.@OBJEXT@:     $(top_srcdir)/pcregrep.c pcre.h config.h
 		$(CC) -c $(CFLAGS) -I. -I$(top_srcdir) $(UTF8) $(UCP) \
 		$(PCREGREP_OSTYPE) $(top_srcdir)/pcregrep.c
 
 # Some Windows-specific targets for MinGW. Do not use for Cygwin.
 
-winshared : .libs/@WIN_PREFIX@pcre.dll .libs/@WIN_PREFIX@pcreposix.dll \
+pcre-dll-res.@OBJEXT@: $(resdir)/pcre-dll-res.rc
+	$(RCTOOL_COMPILE) $<
+pcreposix-dll-res.@OBJEXT@: $(resdir)/pcreposix-dll-res.rc
+	$(RCTOOL_COMPILE) $<
+pcrecpp-dll-res.@OBJEXT@: $(resdir)/pcrecpp-dll-res.rc
+	$(RCTOOL_COMPILE) $<
+
+pcre-dllversion.@OBJEXT@: $(resdir)/pcre-dllversion.c
+	$(LTCOMPILE) $<
+pcreposix-dllversion.@OBJEXT@: $(resdir)/pcreposix-dllversion.c
+	$(LTCOMPILE) $<
+pcrecpp-dllversion.@OBJEXT@: $(resdir)/pcrecpp-dllversion.c
+	$(LTCXXCOMPILE) $<
+
+MAJOR=$(shell echo $(VERSION) | sed -e "s/\..*$$//")
+MINOR=$(shell echo $(VERSION) | sed -e "s/^[^\.]*\.0*\([0-9]\+\).*$$/\1/")
+VERSADD = -Wl,--major-image-version=$(MAJOR) -Wl,--minor-image-version=$(MINOR) 
+
+winshared : #.libs/@WIN_PREFIX@pcre.dll .libs/@WIN_PREFIX@pcreposix.dll \
 		.libs/@WIN_PREFIX@pcrecpp.dll
 
 .libs/@WIN_PREFIX@pcre.dll : libpcre.la
 	$(CC) $(CFLAGS) -shared -o $@ \
-	-Wl,--whole-archive .libs/libpcre.a \
-	-Wl,--out-implib,.libs/libpcre.dll.a \
-	-Wl,--output-def,.libs/@WIN_PREFIX@pcre.dll-def \
-	-Wl,--export-all-symbols \
-	-Wl,--no-whole-archive
+     -Wl,--enable-stdcall-fixup \
+     -Wl,--add-stdcall-alias \
+     $(DLLOBJ) \
+     -Wl,--output-def,.libs/@WIN_PREFIX@pcre.def \
+     $(VERSADD) $(LIBS)
 	sed -e "s#dlname=''#dlname='../bin/@WIN_PREFIX@pcre.dll'#" \
 	-e "s#library_names=''#library_names='libpcre.dll.a'#" \
 	< .libs/libpcre.lai > .libs/libpcre.lai.tmp && \
@@ -392,15 +445,17 @@ winshared : .libs/@WIN_PREFIX@pcre.dll .
 	-e "s#library_names=''#library_names='libpcre.dll.a'#" \
 	< libpcre.la > libpcre.la.tmp && \
 	mv -f libpcre.la.tmp libpcre.la
+	cd .libs && dll2lib	@WIN_PREFIX@pcre.dll -l @WIN_PREFIX@pcre -d @WIN_PREFIX@pcre.def
 
 
 .libs/@WIN_PREFIX@pcreposix.dll: libpcreposix.la libpcre.la
 	$(CC) $(CFLAGS) -shared -o $@ \
-	-Wl,--whole-archive .libs/libpcreposix.a \
-	-Wl,--out-implib,.libs/@WIN_PREFIX@pcreposix.dll.a \
-	-Wl,--output-def,.libs/@WIN_PREFIX@libpcreposix.dll-def \
-	-Wl,--export-all-symbols \
-	-Wl,--no-whole-archive .libs/libpcre.a
+	-Wl,--enable-stdcall-fixup \
+	-Wl,--add-stdcall-alias \
+	$(DLLPOSIXOBJ) \
+	-Wl,--out-implib,.libs/libpcreposix.dll.a \
+	-Wl,--output-def,.libs/@WIN_PREFIX@pcreposix.def \
+	-Wl,--no-whole-archive .libs/libpcre.dll.a $(VERSADD) $(LIBS)
 	sed -e "s#dlname=''#dlname='../bin/@WIN_PREFIX@pcreposix.dll'#" \
 	-e "s#library_names=''#library_names='libpcreposix.dll.a'#"\
 	< .libs/libpcreposix.lai > .libs/libpcreposix.lai.tmp && \
@@ -409,14 +464,18 @@ winshared : .libs/@WIN_PREFIX@pcre.dll .
 	-e "s#library_names=''#library_names='libpcreposix.dll.a'#"\
 	< libpcreposix.la > libpcreposix.la.tmp && \
 	mv -f libpcreposix.la.tmp libpcreposix.la
+	cd .libs && dll2lib	@WIN_PREFIX@pcreposix.dll -l @WIN_PREFIX@pcreposix -d @WIN_PREFIX@pcreposix.def
 
 .libs/@WIN_PREFIX@pcrecpp.dll: libpcrecpp.la libpcre.la
 	$(CXX) $(CXXFLAGS) -shared -o $@ \
-	-Wl,--whole-archive .libs/libpcrecpp.a \
-	-Wl,--out-implib,.libs/@WIN_PREFIX@pcrecpp.dll.a \
-	-Wl,--output-def,.libs/@WIN_PREFIX@libpcrecpp.dll-def \
+	-Wl,--enable-stdcall-fixup \
+	-Wl,--add-stdcall-alias \
+	-Wl,--allow-multiple-definition \
+	-Wl,--whole-archive $(DLLCPPOBJ)  \
 	-Wl,--export-all-symbols \
-	-Wl,--no-whole-archive .libs/libpcre.a
+	-Wl,--out-implib,.libs/libpcrecpp.dll.a \
+	-Wl,--output-def,.libs/@WIN_PREFIX@pcrecpp.dll-def \
+	-Wl,--no-whole-archive .libs/libpcre.dll.a $(VERSADD) $(LIBS)
 	sed -e "s#dlname=''#dlname='../bin/@WIN_PREFIX@pcrecpp.dll'#" \
 	-e "s#library_names=''#library_names='libpcrecpp.dll.a'#"\
 	< .libs/libpcrecpp.lai > .libs/libpcrecpp.lai.tmp && \
@@ -426,21 +485,22 @@ winshared : .libs/@WIN_PREFIX@pcre.dll .
 	< libpcrecpp.la > libpcrecpp.la.tmp && \
 	mv -f libpcrecpp.la.tmp libpcrecpp.la
 
+#	.libs/libpcrecpp.a 
 
 wininstall : winshared
 	$(mkinstalldirs) $(DESTDIR)$(LIBDIR)
 	$(mkinstalldirs) $(DESTDIR)$(BINDIR)
-	$(INSTALL) .libs/@WIN_PREFIX@pcre.dll $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcre.dll
-	$(INSTALL) .libs/@WIN_PREFIX@pcreposix.dll $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcreposix.dll
-	$(INSTALL) .libs/@WIN_PREFIX@libpcreposix.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcreposix.dll.a
-	$(INSTALL) .libs/@WIN_PREFIX@libpcre.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcre.dll.a
-@HAVE_CPP@	 $(INSTALL) .libs/@WIN_PREFIX@pcrecpp.dll $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcrecpp.dll
-@HAVE_CPP@	 $(INSTALL) .libs/@WIN_PREFIX@libpcrecpp.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcrecpp.dll.a
-	-strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcre.dll
-	-strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcreposix.dll
-@HAVE_CPP@	 -strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcrecpp.dll
-	-strip $(DESTDIR)$(BINDIR)/pcregrep@EXEEXT@
-	-strip $(DESTDIR)$(BINDIR)/pcretest@EXEEXT@
+	$(INSTALL) .libs/@WIN_PREFIX@pcre*.dll $(DESTDIR)$(BINDIR)
+	$(INSTALL) .libs/@WIN_PREFIX@pcreposix*.dll $(DESTDIR)$(BINDIR)
+#	$(INSTALL) .libs/@WIN_PREFIX@libpcreposix.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcreposix.dll.a
+#	$(INSTALL) .libs/@WIN_PREFIX@libpcre.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcre.dll.a
+@HAVE_CPP@	 $(INSTALL) .libs/@WIN_PREFIX@pcrecpp*.dll $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcrecpp.dll
+#@HAVE_CPP@	 $(INSTALL) .libs/@WIN_PREFIX@libpcrecpp.dll.a $(DESTDIR)$(LIBDIR)/@WIN_PREFIX@libpcrecpp.dll.a
+#	-strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcre.dll
+#	-strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcreposix.dll
+#@HAVE_CPP@	 -strip -g $(DESTDIR)$(BINDIR)/@WIN_PREFIX@pcrecpp.dll
+#	-strip $(DESTDIR)$(BINDIR)/pcregrep@EXEEXT@
+#	-strip $(DESTDIR)$(BINDIR)/pcretest@EXEEXT@
 
 # An auxiliary program makes the default character table source. This is put
 # in the current directory, NOT the $top_srcdir directory.
@@ -450,12 +510,15 @@ pcre_chartables.c:   dftables@BUILD_EXEE
 
 dftables.@BUILD_OBJEXT@:     $(top_srcdir)/dftables.c \
 		$(top_srcdir)/pcre_maketables.c $(top_srcdir)/pcre_internal.h \
-		pcre.h config.h Makefile
+		pcre.h config.h 
 		$(CC_FOR_BUILD) -c $(CFLAGS_FOR_BUILD) -I. $(top_srcdir)/dftables.c
 
 dftables@BUILD_EXEEXT@:      dftables.@BUILD_OBJEXT@
 		$(LINK_FOR_BUILD) -o dftables@BUILD_EXEEXT@ dftables.@OBJEXT@
 
+#Makefile: Makefile.in
+#	./config.status
+
 install:        all @ON_WINDOWS@ wininstall
 @NOT_ON_WINDOWS@	       $(mkinstalldirs) $(DESTDIR)$(LIBDIR)
 @NOT_ON_WINDOWS@	       echo "$(LIBTOOL) --mode=install $(INSTALL) libpcre.la $(DESTDIR)$(LIBDIR)/libpcre.la"
@@ -511,6 +574,8 @@ install:        all @ON_WINDOWS@ wininst
 		$(mkinstalldirs) $(DESTDIR)$(BINDIR)
 		$(LIBTOOL) --mode=install $(INSTALL) pcregrep@EXEEXT@ $(DESTDIR)$(BINDIR)/pcregrep@EXEEXT@
 		$(LIBTOOL) --mode=install $(INSTALL) pcretest@EXEEXT@ $(DESTDIR)$(BINDIR)/pcretest@EXEEXT@
+		-strip $(DESTDIR)$(BINDIR)/pcregrep@EXEEXT@
+		-strip $(DESTDIR)$(BINDIR)/pcretest@EXEEXT@
 		$(INSTALL) pcre-config $(DESTDIR)$(BINDIR)/pcre-config
 		$(mkinstalldirs) $(DESTDIR)$(LIBDIR)/pkgconfig
 		$(INSTALL_DATA) libpcre.pc $(DESTDIR)$(LIBDIR)/pkgconfig/libpcre.pc
@@ -570,7 +635,7 @@ uninstall:;     -rm -rf \
 # made pcre_chartables.c shouldn't change, and if people have edited the tables
 # by hand, you don't want to throw them away.
 
-clean:;         -rm -rf *.@OBJEXT@ *.lo *.a *.la .libs pcretest@EXEEXT@ pcre_stringpiece_unittest@EXEEXT@ pcrecpp_unittest@EXEEXT@ pcre_scanner_unittest@EXEEXT@ pcregrep@EXEEXT@ testtry
+clean:;			-rm -rf *.@OBJEXT@ *.lo *.a *.la .libs pcretest@EXEEXT@ pcre_stringpiece_unittest@EXEEXT@ pcrecpp_unittest@EXEEXT@ pcre_scanner_unittest@EXEEXT@ pcregrep@EXEEXT@ testtry dftables@EXEEXT@
 
 # But "make distclean" should get back to a virgin distribution
 
@@ -587,16 +652,17 @@ check:          runtest
 
 test:           runtest
 
-runtest:        all @ON_WINDOWS@ @WIN_PREFIX@pcre.dll
+runtest:		  all #@ON_WINDOWS@ .libs/@WIN_PREFIX@pcre.dll
 		@./RunTest
 		@./RunGrepTest
+		@cat testtry
 @HAVE_CPP@		 @echo ""
 @HAVE_CPP@		 @echo "Testing C++ wrapper"
 @HAVE_CPP@		 @echo ""; echo "Test 1++: stringpiece"
-@HAVE_CPP@		 @./pcre_stringpiece_unittest@EXEEXT@
+@HAVE_CPP@		 PATH=.:.libs:$$PATH && ./pcre_stringpiece_unittest@EXEEXT@
 @HAVE_CPP@		 @echo ""; echo "Test 2++: RE class"
-@HAVE_CPP@		 @./pcrecpp_unittest@EXEEXT@
+@HAVE_CPP@		 PATH=.:.libs:$$PATH && ./pcrecpp_unittest@EXEEXT@
 @HAVE_CPP@		 @echo ""; echo "Test 3++: Scanner class"
-@HAVE_CPP@		 @./pcre_scanner_unittest@EXEEXT@
+@HAVE_CPP@		 PATH=.:.libs:$$PATH && ./pcre_scanner_unittest@EXEEXT@
 
 # End
diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/RunGrepTest.in pcre-6.5-src/RunGrepTest.in
--- pcre-6.5-orig/RunGrepTest.in	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/RunGrepTest.in	2006-02-05 11:19:43.781250000 +0100
@@ -3,8 +3,10 @@
 # This file is generated by configure from RunGrepTest.in. Make any changes
 # to that file.
 
+PATH=.libs:$PATH
+
 echo "Testing pcregrep"
-./pcregrep -V
+pcregrep -V
 
 # Run pcregrep tests. The assumption is that the PCRE tests check the library
 # itself. What we are checking here is the file handling and options that are
@@ -13,7 +15,7 @@ echo "Testing pcregrep"
 cf=diff
 valgrind=
 if [ ! -d testdata ] ; then
-  ln -s @top_srcdir@/testdata testdata
+  cp -fpr @top_srcdir@/testdata .
 fi
 testdata=./testdata
 
@@ -26,162 +28,162 @@ while [ $# -gt 0 ] ; do
 done
 
 echo "---------------------------- Test 1 ------------------------------" >testtry
-$valgrind ./pcregrep PATTERN $testdata/grepinput >>testtry
+$valgrind pcregrep PATTERN $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 2 ------------------------------" >>testtry
-$valgrind ./pcregrep '^PATTERN' $testdata/grepinput >>testtry
+$valgrind pcregrep '^PATTERN' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 3 ------------------------------" >>testtry
-$valgrind ./pcregrep -in PATTERN $testdata/grepinput >>testtry
+$valgrind pcregrep -in PATTERN $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 4 ------------------------------" >>testtry
-$valgrind ./pcregrep -ic PATTERN $testdata/grepinput >>testtry
+$valgrind pcregrep -ic PATTERN $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 5 ------------------------------" >>testtry
-$valgrind ./pcregrep -in PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -in PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 6 ------------------------------" >>testtry
-$valgrind ./pcregrep -inh PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -inh PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 7 ------------------------------" >>testtry
-$valgrind ./pcregrep -il PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -il PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 8 ------------------------------" >>testtry
-$valgrind ./pcregrep -l PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -l PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 9 ------------------------------" >>testtry
-$valgrind ./pcregrep -q PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -q PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 10 -----------------------------" >>testtry
-$valgrind ./pcregrep -q NEVER-PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -q NEVER-PATTERN $testdata/grepinput $testdata/grepinputx >>testtry
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 11 -----------------------------" >>testtry
-$valgrind ./pcregrep -vn pattern $testdata/grepinputx >>testtry
+$valgrind pcregrep -vn pattern $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 12 -----------------------------" >>testtry
-$valgrind ./pcregrep -ix pattern $testdata/grepinputx >>testtry
+$valgrind pcregrep -ix pattern $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 13 -----------------------------" >>testtry
-$valgrind ./pcregrep -f$testdata/greplist $testdata/grepinputx >>testtry
+$valgrind pcregrep -f$testdata/greplist $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 14 -----------------------------" >>testtry
-$valgrind ./pcregrep -w pat $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -w pat $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 15 -----------------------------" >>testtry
-$valgrind ./pcregrep 'abc^*' $testdata/grepinput 2>>testtry >>testtry
+$valgrind pcregrep 'abc^*' $testdata/grepinput 2>>testtry >>testtry
 
 echo "---------------------------- Test 16 -----------------------------" >>testtry
-$valgrind ./pcregrep abc $testdata/grepinput $testdata/nonexistfile 2>>testtry >>testtry
+$valgrind pcregrep abc $testdata/grepinput $testdata/nonexistfile 2>>testtry >>testtry
 
 echo "---------------------------- Test 17 -----------------------------" >>testtry
-$valgrind ./pcregrep -M 'the\noutput' $testdata/grepinput >>testtry
+$valgrind pcregrep -M 'the\noutput' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 18 -----------------------------" >>testtry
-$valgrind ./pcregrep -Mn '(the\noutput|dog\.\n--)' $testdata/grepinput >>testtry
+$valgrind pcregrep -Mn '(the\noutput|dog\.\n--)' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 19 -----------------------------" >>testtry
-$valgrind ./pcregrep -Mix 'Pattern' $testdata/grepinputx >>testtry
+$valgrind pcregrep -Mix 'Pattern' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 20 -----------------------------" >>testtry
-$valgrind ./pcregrep -Mixn 'complete pair\nof lines' $testdata/grepinputx >>testtry
+$valgrind pcregrep -Mixn 'complete pair\nof lines' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 21 -----------------------------" >>testtry
-$valgrind ./pcregrep -nA3 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -nA3 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 22 -----------------------------" >>testtry
-$valgrind ./pcregrep -nB3 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -nB3 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 23 -----------------------------" >>testtry
-$valgrind ./pcregrep -C3 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -C3 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 24 -----------------------------" >>testtry
-$valgrind ./pcregrep -A9 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -A9 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 25 -----------------------------" >>testtry
-$valgrind ./pcregrep -nB9 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -nB9 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 26 -----------------------------" >>testtry
-$valgrind ./pcregrep -A9 -B9 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -A9 -B9 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 27 -----------------------------" >>testtry
-$valgrind ./pcregrep -A10 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -A10 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 28 -----------------------------" >>testtry
-$valgrind ./pcregrep -nB10 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -nB10 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 29 -----------------------------" >>testtry
-$valgrind ./pcregrep -C12 -B10 'four' $testdata/grepinputx >>testtry
+$valgrind pcregrep -C12 -B10 'four' $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 30 -----------------------------" >>testtry
-$valgrind ./pcregrep -inB3 'pattern' $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -inB3 'pattern' $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 31 -----------------------------" >>testtry
-$valgrind ./pcregrep -inA3 'pattern' $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -inA3 'pattern' $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 32 -----------------------------" >>testtry
-$valgrind ./pcregrep -L 'fox' $testdata/grepinput $testdata/grepinputx >>testtry
+$valgrind pcregrep -L 'fox' $testdata/grepinput $testdata/grepinputx >>testtry
 
 echo "---------------------------- Test 33 -----------------------------" >>testtry
-$valgrind ./pcregrep 'fox' $testdata/grepnonexist >>testtry 2>&1 
+$valgrind pcregrep 'fox' $testdata/grepnonexist >>testtry 2>&1 
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 34 -----------------------------" >>testtry
-$valgrind ./pcregrep -s 'fox' $testdata/grepnonexist >>testtry 2>&1 
+$valgrind pcregrep -s 'fox' $testdata/grepnonexist >>testtry 2>&1 
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 35 -----------------------------" >>testtry
-$valgrind ./pcregrep -L -r --include=grepinputx 'fox' $testdata >>testtry 
+$valgrind pcregrep -L -r --include=grepinputx 'fox' $testdata >>testtry 
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 36 -----------------------------" >>testtry
-$valgrind ./pcregrep -L -r --include=grepinput --exclude 'grepinput$' 'fox' $testdata >>testtry 
+$valgrind pcregrep -L -r --include=grepinput --exclude 'grepinput$' 'fox' $testdata >>testtry 
 echo "RC=$?" >>testtry
 
 echo "---------------------------- Test 37 -----------------------------" >>testtry
-$valgrind ./pcregrep  '^(a+)*\d' $testdata/grepinput >>testtry 2>teststderr
+$valgrind pcregrep  '^(a+)*\d' $testdata/grepinput >>testtry 2>teststderr
 echo "RC=$?" >>testtry
 echo "======== STDERR ========" >>testtry
 cat teststderr >>testtry
 
 echo "---------------------------- Test 38 ------------------------------" >>testtry
-$valgrind ./pcregrep '>\x00<' $testdata/grepinput >>testtry
+$valgrind pcregrep '>\x00<' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 39 ------------------------------" >>testtry
-$valgrind ./pcregrep -A1 'before the binary zero' $testdata/grepinput >>testtry
+$valgrind pcregrep -A1 'before the binary zero' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 40 ------------------------------" >>testtry
-$valgrind ./pcregrep -B1 'after the binary zero' $testdata/grepinput >>testtry
+$valgrind pcregrep -B1 'after the binary zero' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 41 ------------------------------" >>testtry
-$valgrind ./pcregrep -B1 -o '\w+ the binary zero' $testdata/grepinput >>testtry
+$valgrind pcregrep -B1 -o '\w+ the binary zero' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 41 ------------------------------" >>testtry
-$valgrind ./pcregrep -B1 -onH '\w+ the binary zero' $testdata/grepinput >>testtry
+$valgrind pcregrep -B1 -onH '\w+ the binary zero' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 42 ------------------------------" >>testtry
-$valgrind ./pcregrep -on 'before|zero|after' $testdata/grepinput >>testtry
+$valgrind pcregrep -on 'before|zero|after' $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 43 ------------------------------" >>testtry
-$valgrind ./pcregrep -on -e before -e zero -e after $testdata/grepinput >>testtry
+$valgrind pcregrep -on -e before -e zero -e after $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 44 ------------------------------" >>testtry
-$valgrind ./pcregrep -on -f $testdata/greplist -e binary $testdata/grepinput >>testtry
+$valgrind pcregrep -on -f $testdata/greplist -e binary $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 45 ------------------------------" >>testtry
-$valgrind ./pcregrep -e abc -e '(unclosed' $testdata/grepinput 2>>testtry >>testtry
+$valgrind pcregrep -e abc -e '(unclosed' $testdata/grepinput 2>>testtry >>testtry
 
 echo "---------------------------- Test 46 ------------------------------" >>testtry
-$valgrind ./pcregrep -Fx "AB.VE
+$valgrind pcregrep -Fx "AB.VE
 elephant" $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 47 ------------------------------" >>testtry
-$valgrind ./pcregrep -F "AB.VE
+$valgrind pcregrep -F "AB.VE
 elephant" $testdata/grepinput >>testtry
 
 echo "---------------------------- Test 48 ------------------------------" >>testtry
-$valgrind ./pcregrep -F -e DATA -e "AB.VE
+$valgrind pcregrep -F -e DATA -e "AB.VE
 elephant" $testdata/grepinput >>testtry
 
 # Now compare the results.
diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/RunTest.in pcre-6.5-src/RunTest.in
--- pcre-6.5-orig/RunTest.in	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/RunTest.in	2006-02-05 11:17:46.312500000 +0100
@@ -8,10 +8,10 @@
 cf=diff
 valgrind=
 if [ ! -d testdata ] ; then
-  ln -s @top_srcdir@/testdata testdata
+  cp -fpr @top_srcdir@/testdata .
 fi
 testdata=./testdata
-
+PATH=.libs:$PATH
 
 # Select which tests to run; if no selection, run all
 
@@ -107,13 +107,13 @@ fi
 
 # Show which release
 
-./pcretest /dev/null
+pcretest NUL
 
 # Primary test, Perl-compatible
 
 if [ $do1 = yes ] ; then
   echo "Test 1: main functionality (Perl compatible)"
-  $valgrind ./pcretest -q $testdata/testinput1 testtry
+  $valgrind pcretest -q $testdata/testinput1 testtry
   if [ $? = 0 ] ; then
     $cf testtry $testdata/testoutput1
     if [ $? != 0 ] ; then exit 1; fi
@@ -128,7 +128,7 @@ fi
 if [ $do2 = yes ] ; then
   if [ "@LINK_SIZE@" = "" -o "@LINK_SIZE@" = "-DLINK_SIZE=2" ] ; then
     echo "Test 2: API and error handling (not Perl compatible)"
-    $valgrind ./pcretest -q -i $testdata/testinput2 testtry
+    $valgrind pcretest -q -i $testdata/testinput2 testtry
     if [ $? = 0 ] ; then
       $cf testtry $testdata/testoutput2
       if [ $? != 0 ] ; then exit 1; fi
@@ -148,7 +148,7 @@ if [ $do3 = yes ] ; then
   locale -a | grep '^fr_FR$' >/dev/null
   if [ $? -eq 0 ] ; then
     echo "Test 3: locale-specific features (using 'fr_FR' locale)"
-    $valgrind ./pcretest -q $testdata/testinput3 testtry
+    $valgrind pcretest -q $testdata/testinput3 testtry
     if [ $? = 0 ] ; then
       $cf testtry $testdata/testoutput3
       if [ $? != 0 ] ; then
@@ -173,7 +173,7 @@ fi
 
 if [ $do4 = yes ] ; then
   echo "Test 4: UTF-8 support (Perl compatible)"
-  $valgrind ./pcretest -q $testdata/testinput4 testtry
+  $valgrind pcretest -q $testdata/testinput4 testtry
   if [ $? = 0 ] ; then
     $cf testtry $testdata/testoutput4
     if [ $? != 0 ] ; then exit 1; fi
@@ -186,7 +186,7 @@ fi
 if [ $do5 = yes ] ; then
   if [ "@LINK_SIZE@" = "" -o "@LINK_SIZE@" = "-DLINK_SIZE=2" ] ; then
     echo "Test 5: API and internals for UTF-8 support (not Perl compatible)"
-    $valgrind ./pcretest -q $testdata/testinput5 testtry
+    $valgrind pcretest -q $testdata/testinput5 testtry
     if [ $? = 0 ] ; then
       $cf testtry $testdata/testoutput5
       if [ $? != 0 ] ; then exit 1; fi
@@ -203,7 +203,7 @@ fi
 if [ $do6 = yes ] ; then
   if [ "@LINK_SIZE@" = "" -o "@LINK_SIZE@" = "-DLINK_SIZE=2" ] ; then
     echo "Test 6: Unicode property support"
-    $valgrind ./pcretest -q $testdata/testinput6 testtry
+    $valgrind pcretest -q $testdata/testinput6 testtry
     if [ $? = 0 ] ; then
       $cf testtry $testdata/testoutput6
       if [ $? != 0 ] ; then exit 1; fi
@@ -221,7 +221,7 @@ fi
 
 if [ $do7 = yes ] ; then
   echo "Test 7: DFA matching"
-  $valgrind ./pcretest -q -dfa $testdata/testinput7 testtry
+  $valgrind pcretest -q -dfa $testdata/testinput7 testtry
   if [ $? = 0 ] ; then
     $cf testtry $testdata/testoutput7
     if [ $? != 0 ] ; then exit 1; fi
@@ -233,7 +233,7 @@ fi
 
 if [ $do8 = yes ] ; then
   echo "Test 8: DFA matching with UTF-8"
-  $valgrind ./pcretest -q -dfa $testdata/testinput8 testtry
+  $valgrind pcretest -q -dfa $testdata/testinput8 testtry
   if [ $? = 0 ] ; then
     $cf testtry $testdata/testoutput8
     if [ $? != 0 ] ; then exit 1; fi
@@ -245,7 +245,7 @@ fi
 
 if [ $do9 = yes ] ; then
   echo "Test 9: DFA matching with Unicode properties"
-  $valgrind ./pcretest -q -dfa $testdata/testinput9 testtry
+  $valgrind pcretest -q -dfa $testdata/testinput9 testtry
   if [ $? = 0 ] ; then
     $cf testtry $testdata/testoutput9
     if [ $? != 0 ] ; then exit 1; fi
diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/configure pcre-6.5-src/configure
--- pcre-6.5-orig/configure	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/configure	2006-02-04 12:53:44.859375000 +0100
@@ -1509,8 +1509,8 @@ ac_compiler_gnu=$ac_cv_c_compiler_gnu
 POSIX_MALLOC_THRESHOLD=-DPOSIX_MALLOC_THRESHOLD=10
 
 
-PCRE_LIB_VERSION=0:1:0
-PCRE_POSIXLIB_VERSION=0:0:0
+PCRE_LIB_VERSION=15:0:12
+PCRE_POSIXLIB_VERSION=15:0:12
 PCRE_CPPLIB_VERSION=0:0:0
 
 
diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/pcre-config.in pcre-6.5-src/pcre-config.in
--- pcre-6.5-orig/pcre-config.in	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/pcre-config.in	2006-02-04 12:53:44.875000000 +0100
@@ -52,10 +52,10 @@ while test $# -gt 0; do
       echo $includes
       ;;
     --libs-posix)
-      echo -L@libdir@$libR -lpcreposix -lpcre
+      echo -L@libdir@$libR -lpcreposix -lpcre @LIBS@
       ;;
     --libs)
-      echo -L@libdir@$libR -lpcre
+      echo -L@libdir@$libR -lpcre @LIBS@
       ;;
     *)
       echo "${usage}" 1>&2
diff -ipuwr --binary --strip-trailing-cr -x '*.bak' -x '*.orig' -x '*.rej' -x '*.new' -x '*~' -x debian -x '*.po' -x '*.pot' pcre-6.5-orig/pcrecpp.cc pcre-6.5-src/pcrecpp.cc
--- pcre-6.5-orig/pcrecpp.cc	2006-02-02 12:04:11.000000000 +0100
+++ pcre-6.5-src/pcrecpp.cc	2006-02-04 12:53:44.875000000 +0100
@@ -41,9 +41,9 @@
 // We need this to compile the proper dll on windows/msys.  This is copied
 // from pcre_internal.h.  It would probably be better just to include that.
 #define PCRE_DEFINITION  /* Win32 __declspec(export) trigger for .dll */
-#include "pcre.h"
-#include "pcre_stringpiece.h"
 #include "pcrecpp.h"
+#include "pcre_stringpiece.h"
+#include "pcre.h"
 
 
 namespace pcrecpp {
